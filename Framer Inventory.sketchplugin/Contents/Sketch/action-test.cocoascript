// @import 'inventory/layer-compilation.cocoascript'

@import 'inventory/classes/layer.cocoascript'
@import 'inventory/libs/pluginDefaults.js'

var presets = {
    myRetina: "retina",
}

var pluginDomain = "com.addleimb.framer-inventory.retina"
var userRetinaDefaults = initDefaults(pluginDomain, presets)


var onRun = function(context) {
	log("\n")
	var doc = context.document
	var selection = context.selection
	var layers = []
	var pasteboardContent = []
	
	var retinaProperty = userRetinaDefaults.myRetina || "retina"

	
	userRetinaDefaults.myRetina = retinaProperty
	saveDefaults(userRetinaDefaults)
	
	if (selection != nil) {
		for (var i = 0; i < [selection count]; i++) {
			var currentLayer = [selection objectAtIndex: i]
			var layer = new Layer([currentLayer name])
			layer.addState(currentLayer)
			layers.push(layer)
		}
	}
	

	for (var i = 0; i < layers.length; i++) {
		pasteboardContent += layers[i].printLayer()
	}
	
	[[NSPasteboard generalPasteboard] clearContents];
	[[NSPasteboard generalPasteboard] setString:pasteboardContent  forType:NSStringPboardType];
	[doc showMessage:"Done"]
}


	
